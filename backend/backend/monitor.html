<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VAL Core - Service Monitor Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            background: linear-gradient(135deg, #1a1a2 0%, #0d1117 100%);
            color: #ffffff;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            backdrop-filter: blur(10px);
        }

        .header h1 {
            margin: 0 0 10px 0;
            font-size: 2.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            color: transparent;
            margin: 0 5px;
        }

        .subtitle {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 20px;
        }

        .status-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .status-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .status-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .status-header {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            gap: 15px;
        }

        .status-light {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 4px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s;
        }

        .status-light.active {
            background: #00ff00;
            box-shadow: 0 0 15px 5px #00ff00;
            animation: pulse 2s infinite;
        }

        .status-light.inactive {
            background: #ff4444;
            box-shadow: 0 0 10px 5px rgba(255, 68, 68, 0.3);
        }

        .status-light.connecting {
            background: #ffaa00;
            animation: blink 0.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .service-name {
            font-size: 1.3rem;
            font-weight: 600;
            margin: 0 0 10px 0;
            color: #ffffff;
        }

        .service-type {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 5px;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .btn:active {
            transform: translateY(0);
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .btn-start {
            background: linear-gradient(135deg, #00ff00 0%, #00cc00 100%);
            color: #ffffff;
        }

        .btn-stop {
            background: linear-gradient(135deg, #ff4444 0%, #cc0000 100%);
            color: #ffffff;
        }

        .section {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.5rem;
            margin: 0 0 20px 0;
            color: #667eea;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title::after {
            content: '';
            flex: 1;
            height: 3px;
            background: linear-gradient(90deg, transparent, #667eea);
            margin-left: 20px;
        }

        .adapter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .adapter-card {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid transparent;
            transition: all 0.3s;
        }

        .adapter-card:hover {
            border-left-color: #667eea;
            background: rgba(255, 255, 255, 0.12);
        }

        .adapter-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .adapter-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: #1a1a2;
        }

        .adapter-type {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.6);
            padding: 4px 8px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
        display: inline-block;
        margin-left: 10px;
        margin-bottom: 10px;
        white-space: nowrap;
        overflow: hidden;
            text-overflow: ellipsis;
            max-width: 200px;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        letter-spacing: 0.5px;
            margin-left: 15px;
        white-space: nowrap;
        overflow: hidden;
            text-overflow: ellipsis;
            max-width: 150px;
        }

        .status-badge.production {
            background: #00aa00;
            color: #ffffff;
        }

        .status-badge.mock {
            background: #6c757d;
            color: #ffffff;
        }

        .status-badge.unknown {
            background: #6c757d;
            color: #ffffff;
        }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        .info-item {
            background: rgba(0, 0, 0, 0.2);
            padding: 10px;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .info-label {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.6);
        }

        .info-value {
            font-size: 1rem;
            font-weight: 600;
            color: #ffffff;
        }

        .info-value.green {
            color: #00ff00;
        }

        .info-value.red {
            color: #ff4444;
        }

        .log-panel {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
        }

        .log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .log-title {
            font-size: 1rem;
            color: #667eea;
            font-weight: 600;
        }

        .log-actions {
            display: flex;
            gap: 10px;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.85rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.1);
            color: #667eea;
            transition: all 0.2s;
        }

        .btn-small:hover {
            background: rgba(102, 126, 234, 0.9);
        }

        .log-entry {
            padding: 10px;
            margin-bottom: 10px;
            border-left: 3px solid transparent;
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.02);
            font-size: 0.9rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .log-entry:last-child {
            border-left-color: transparent;
        }

        .log-time {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.5);
            min-width: 120px;
        }

        .log-message {
            flex: 1;
            color: #ffffff;
        overflow: hidden;
            text-overflow: ellipsis;
            max-width: 400px;
        }

        .empty-log {
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
            font-style: italic;
            padding: 40px;
        }

        .footer {
            text-align: center;
            padding: 30px 20px;
            margin-top: 40px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
        }

        .last-update {
            margin-top: 20px;
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.5);
        }

        .success-message {
            background: linear-gradient(135deg, #00ff00 0%, #00cc00 100%);
            color: #ffffff;
            padding: 15px 25px;
            border-radius: 8px;
            text-align: center;
            font-size: 1.1rem;
            display: none;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .error-message {
            background: linear-gradient(135deg, #ff4444 0%, #cc0000 100%);
            color: #ffffff;
            padding: 15px 25px;
            border-radius: 8px;
            text-align: center;
            font-size: 1.1rem;
            display: none;
            animation: slideIn 0.5s ease-out;
        }

        @media (max-width: 768px) {
            .adapter-grid {
                grid-template-columns: 1fr;
            }

            .info-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>VAL CORE - SERVICE MONITOR</h1>
            <p class="subtitle">Real-time status dashboard for VAL Core infrastructure services</p>
        </div>

        <!-- Status Overview Cards -->
        <div class="status-overview">
            <div class="status-card">
                <div class="status-header">
                    <div class="status-light inactive" id="light-pgsql" title="PostgreSQL (Narrative Mirror)"></div>
                    <div>
                        <div class="service-name">PostgreSQL</div>
                        <div class="service-type">Narrative Mirror</div>
                    </div>
                </div>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Port:</span>
                        <span class="info-value">5432</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Status:</span>
                        <span class="info-value red" id="status-pgsql">Stopped</span>
                    </div>
                </div>
            </div>

            <div class="status-card">
                <div class="status-header">
                    <div class="status-light inactive" id="light-tb" title="TigerBeetle (Clearing Authority)"></div>
                    <div>
                        <div class="service-name">TigerBeetle</div>
                        <div class="service-type">Clearing Authority</div>
                    </div>
                </div>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Port:</span>
                        <span class="info-value">3000</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Cluster:</span>
                        <span class="info-value" id="cluster-tb">Unknown</span>
                    </div>
                </div>
            </div>

            <div class="status-card">
                <div class="status-header">
                    <div class="status-light inactive" id="light-webhook" title="Webhook Service"></div>
                    <div>
                        <div class="service-name">Webhook</div>
                        <div class="service-type">Adapter Notifications</div>
                    </div>
                </div>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Port:</span>
                        <span class="info-value">3002</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Status:</span>
                        <span class="info-value red" id="status-webhook">Stopped</span>
                    </div>
                </div>
            </div>

            <div class="status-card">
                <div class="status-header">
                    <div class="status-light inactive" id="light-server" title="VAL Backend Server"></div>
                    <div>
                        <div class="service-name">VAL Backend</div>
                        <div class="service-type">Authority Gateway</div>
                    </div>
                </div>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Port:</span>
                        <span class="info-value">3001</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Status:</span>
                        <span class="info-value red" id="status-server">Stopped</span>
                    </div>
                </div>
            </div>

            <div class="status-card">
                <div class="controls">
                    <button class="btn btn-start" onclick="startAllServices()">‚ñ∂ Start All Services</button>
                    <button class="btn btn-stop" onclick="stopAllServices()">‚è∏ Stop All Services</button>
                    <button class="btn-small" onclick="refreshStatus()">‚ü≥ Refresh</button>
                </div>
            </div>
        </div>

        <!-- External API Adapters -->
        <div class="section">
            <div class="section-title">
                üîÑ External API Adapters
            </div>

            <div class="adapter-grid">
                <div class="adapter-card">
                    <div class="adapter-header">
                        <div>
                            <div class="adapter-name">Tango Card API</div>
                            <div class="adapter-type">GROCERY</div>
                        </div>
                        <span class="status-badge unknown" id="badge-tango">Unknown</span>
                    </div>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Mode:</span>
                            <span class="info-value">Sandbox</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Status:</span>
                            <span class="info-value red" id="status-tango">Disconnected</span>
                        </div>
                    </div>
                </div>

                <div class="adapter-card">
                    <div class="adapter-header">
                        <div>
                            <div class="adapter-name">Arcus Bill-Pay</div>
                            <div class="adapter-type">UTILITY</div>
                        </div>
                        <span class="status-badge production" id="badge-arcus">Production</span>
                    </div>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Mode:</span>
                            <span class="info-value">Sandbox</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Status:</span>
                            <span class="info-value red" id="status-arcus">Disconnected</span>
                        </div>
                    </div>
                </div>

                <div class="adapter-card">
                    <div class="adapter-header">
                        <div>
                            <div class="adapter-name">Moov Push-to-Card</div>
                            <div class="adapter-type">CASH_OUT</div>
                        </div>
                        <span class="status-badge unknown" id="badge-moov">Unknown</span>
                    </div>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Mode:</span>
                            <span class="info-value">Not Configured</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Status:</span>
                            <span class="info-value red" id="status-moov">Not Available</span>
                        </div>
                    </div>
                </div>

                <div class="adapter-card">
                    <div class="adapter-header">
                        <div>
                            <div class="adapter-name">Square</div>
                            <div class="adapter-type">GROCERY</div>
                        </div>
                        <span class="status-badge mock" id="badge-square">Mock Only</span>
                    </div>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Mode:</span>
                            <span class="info-value">Mock</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Status:</span>
                            <span class="info-value green" id="status-square">Available</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- E2E Finality System -->
        <div class="section">
            <div class="section-title">
                ‚ö° E2E Finality System
            </div>

            <div class="info-grid">
                <div class="info-item">
                    <span class="info-label">Dispatcher Status:</span>
                    <span class="info-value green" id="dispatcher-status">Ready</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Registered Adapters:</span>
                    <span class="info-value" id="adapter-count">5</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Credit Manager:</span>
                    <span class="info-value green" id="credit-manager">Initialized</span>
                </div>
                <div class="info-item">
                    <span class="info-label">Clearing Timer:</span>
                    <span class="info-value green" id="clearing-timer">Active</span>
                </div>
            </div>
        </div>

        <!-- Event Log Panel -->
        <div class="section">
            <div class="log-header">
                <div class="log-title">üìã System Event Log</div>
                <div class="log-actions">
                    <button class="btn-small" onclick="clearLog()">Clear</button>
                </div>
            </div>
            <div class="log-panel" id="log-panel">
                <div class="empty-log">
                    <p>Event log will appear here as services start...</p>
                    <p>Use the control buttons above to start services.</p>
                </div>
            </div>
        </div>

        <!-- Success/Error Messages -->
        <div class="success-message" id="success-message">
            ‚úÖ All services started successfully!
        </div>
        <div class="error-message" id="error-message">
            ‚ùå Failed to start some services. Check logs above.
        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="last-update">
                Last update: <span id="last-update">Starting...</span>
            </div>
            <div>
                VAL Core Service Monitor v1.0 ‚Ä¢ All services in one dashboard ‚Ä¢ Real-time status
            </div>
        </div>
    </div>

    <script>
        // Service configuration
        const services = {
            postgresql: {
                name: 'PostgreSQL',
                port: 5432,
                healthCheck: '/health'
            },
            tigerbeetle: {
                name: 'TigerBeetle',
                port: 3000,
                healthCheck: null // TigerBeetle doesn't have HTTP health endpoint
            },
            webhook: {
                name: 'Webhook',
                port: 3002,
                healthCheck: '/health'
            },
            server: {
                name: 'VAL Backend',
                port: 3001,
                healthCheck: '/health'
            },
            adapters: {
                tango: {
                    name: 'Tango Card API',
                    apiBase: process.env.TANGO_API_URL || 'https://integration-api.tangocard.com/raas/v2',
                    healthCheck: null
                },
                arcus: {
                    name: 'Arcus Bill-Pay',
                    apiBase: process.env.ARCUS_API_URL || 'https://api.arcus.com',
                    healthCheck: null
                },
                moov: {
                    name: 'Moov Push-to-Card',
                    apiBase: process.env.MOOV_API_URL || 'https://api.moov.io',
                    healthCheck: null
                },
                square: {
                    name: 'Square',
                    apiBase: 'mock',
                    healthCheck: null
                }
            }
        };

        // Status tracking
        let serviceStatus = {
            postgresql: 'inactive',
            tigerbeetle: 'inactive',
            webhook: 'inactive',
            server: 'inactive'
        };

        let adapterStatus = {
            tango: 'unknown',
            arcus: 'unknown',
            moov: 'unknown',
            square: 'mock'
        };

        let eventLog = [];
        let autoRefreshInterval = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            updateLastUpdate();
            autoRefreshInterval = setInterval(refreshStatus, 10000); // Refresh every 10 seconds
        });

        async function refreshStatus() {
            const promises = [];

            // Check PostgreSQL
            promises.push(checkService('postgresql', services.postgresql));
            promises.push(checkService('webhook', services.webhook));
            promises.push(checkService('server', services.server));
            
            // Check adapters
            promises.push(checkService('tango', services.adapters.tango));
            promises.push(checkService('arcus', services.adapters.arcus));

            const results = await Promise.allSettled(promises);

            updateUI(results);
        }

        async function checkService(serviceId, service) {
            const status = document.getElementById(`status-${serviceId}`);
            if (!status) return;

            try {
                if (serviceId === 'tigerbeetle') {
                    // TigerBeetle doesn't have HTTP health check
                    // Assume running if we can simulate checking
                    serviceStatus.tigerbeetle = 'active';
                    updateLight('light-tb', 'active');
                    return 'active';
                } else if (service.healthCheck) {
                    const response = await fetch(`http://localhost:${service.port}${service.healthCheck}`, {
                        method: 'GET',
                        signal: AbortSignal.timeout(3000)
                    });

                    if (response.ok) {
                        return 'active';
                    } else {
                        return 'inactive';
                    }
                } else {
                    // No health check, assume inactive
                    return 'inactive';
                }
            } catch (error) {
                console.error(`Error checking ${service.name}:`, error);
                return 'error';
            }
        }

        function updateLight(lightId, state) {
            const light = document.getElementById(lightId);
            if (!light) return;

            light.className = 'status-light';
            if (state === 'active') {
                light.classList.add('active');
            } else if (state === 'connecting') {
                light.classList.add('connecting');
            } else if (state === 'error') {
                light.classList.add('inactive');
            } else {
                light.classList.add('inactive');
            }
        }

        function updateUI(results) {
            const [pg, tb, webhook, server, tango, arcus] = results;

            // PostgreSQL
            serviceStatus.postgresql = pg;
            updateLight('light-pgsql', pg);
            updateStatus('status-pgsql', pg === 'active' ? 'Running' : pg === 'error' ? 'Error' : 'Stopped');
            if (pg === 'active') addLog('PostgreSQL', 'Narrative Mirror service started');

            // TigerBeetle
            serviceStatus.tigerbeetle = tb;
            updateLight('light-tb', tb);
            updateStatus('cluster-tb', tb === 'active' ? 'Active' : 'Unknown');
            if (tb === 'active') addLog('TigerBeetle', 'Clearing Authority cluster running');

            // Webhook
            serviceStatus.webhook = webhook;
            updateLight('light-webhook', webhook);
            updateStatus('status-webhook', webhook === 'active' ? 'Running' : webhook === 'error' ? 'Error' : 'Stopped');
            if (webhook === 'active') addLog('Webhook', 'Adapter notification service started');

            // VAL Server
            serviceStatus.server = server;
            updateLight('light-server', server);
            updateStatus('status-server', server === 'active' ? 'Running' : server === 'error' ? 'Error' : 'Stopped');
            if (server === 'active') addLog('VAL Server', 'Authority Gateway service started');

            // Tango Adapter
            adapterStatus.tango = tango;
            updateAdapterStatus('tango', tango);

            // Arcus Adapter
            adapterStatus.arcus = arcus;
            updateAdapterStatus('arcus', arcus);

            updateLastUpdate();
        }

        function updateAdapterStatus(adapterId, status) {
            const badge = document.getElementById(`badge-${adapterId}`);
            const status = document.getElementById(`status-${adapterId}`);
            
            if (!badge || !status) return;

            if (status === 'active') {
                badge.textContent = 'Connected';
                badge.className = 'status-badge production';
                status.textContent = 'Connected';
            } else if (status === 'inactive') {
                badge.textContent = 'Disconnected';
                badge.className = 'status-badge unknown';
                status.textContent = 'Disconnected';
            } else if (status === 'error') {
                badge.textContent = 'Error';
                badge.className = 'status-badge unknown';
                status.textContent = 'Error';
            } else {
                badge.textContent = 'Unknown';
                badge.className = 'status-badge unknown';
                status.textContent = 'Unknown';
            }
        }

        function updateStatus(elementId, text) {
            const element = document.getElementById(elementId);
            if (!element) return;
            element.textContent = text;
            element.className = 'info-value';
            
            if (text.includes('Running') || text.includes('Connected')) {
                element.classList.add('green');
            } else if (text.includes('Error')) {
                element.classList.add('red');
            } else if (text.includes('Stopped')) {
                element.classList.add('red');
            } else {
                element.classList.remove('green', 'red');
            }
        }

        function addLog(service, message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const panel = document.getElementById('log-panel');
            
            if (eventLog.length >= 50) {
                eventLog.shift(); // Keep only last 50 entries
            }
            
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            
            const timeSpan = document.createElement('div');
            timeSpan.className = 'log-time';
            timeSpan.textContent = timestamp;
            entry.appendChild(timeSpan);
            
            const messageSpan = document.createElement('div');
            messageSpan.className = 'log-message';
            messageSpan.textContent = message;
            entry.appendChild(messageSpan);
            
            panel.insertBefore(entry, panel.firstChild || null);
            
            // Scroll to top
            panel.scrollTop = 0;
        }

        function clearLog() {
            eventLog = [];
            const panel = document.getElementById('log-panel');
            panel.innerHTML = '<div class="empty-log"><p>Event log will appear here as services start...</p><p>Use the control buttons above to start services.</p></div>';
        }

        async function startAllServices() {
            const startButton = document.querySelector('.btn-start');
            const stopButton = document.querySelector('.btn-stop');
            
            startButton.disabled = true;
            stopButton.disabled = false;

            addLog('System', 'Starting all services...', 'info');
            showMessage('starting');

            try {
                // Simulate starting services (in real deployment, these would be actual API calls)
                await simulateServiceStart('postgresql');
                await simulateServiceStart('tigerbeetle');
                await simulateServiceStart('webhook');
                await simulateServiceStart('server');
                await simulateServiceStart('tango');
                await simulateServiceStart('arcus');

                serviceStatus.postgresql = 'active';
                serviceStatus.tigerbeetle = 'active';
                serviceStatus.webhook = 'active';
                serviceStatus.server = 'active';
                adapterStatus.tango = 'active';
                adapterStatus.arcus = 'active';

                addLog('System', 'All services started successfully!', 'success');
                showMessage('success');

                // Update cluster status
                const clusterStatus = document.getElementById('cluster-tb');
                clusterStatus.textContent = 'Active (5 nodes)';
                clusterStatus.className = 'info-value green';

            } catch (error) {
                addLog('System', `Error starting services: ${error.message}`, 'error');
                showMessage('error');
            }

            startButton.disabled = false;
            stopButton.disabled = true;
        }

        function stopAllServices() {
            const startButton = document.querySelector('.btn-start');
            const stopButton = document.querySelector('.btn-stop');
            
            startButton.disabled = false;
            stopButton.disabled = true;

            addLog('System', 'Stopping all services...', 'info');

            serviceStatus = {
                postgresql: 'inactive',
                tigerbeetle: 'inactive',
                webhook: 'inactive',
                server: 'inactive'
            };

            adapterStatus = {
                tango: 'unknown',
                arcus: 'unknown',
                moov: 'unknown',
                square: 'mock'
            };

            updateLight('light-pgsql', 'inactive');
            updateLight('light-tb', 'inactive');
            updateLight('light-webhook', 'inactive');
            updateLight('light-server', 'inactive');
            updateStatus('status-pgsql', 'Stopped');
            updateStatus('status-tb', 'Unknown');
            updateStatus('status-webhook', 'Stopped');
            updateStatus('status-server', 'Stopped');
            updateAdapterStatus('tango', 'unknown');
            updateAdapterStatus('arcus', 'unknown');

            const clusterStatus = document.getElementById('cluster-tb');
            clusterStatus.textContent = 'Unknown';
            clusterStatus.className = 'info-value';

            addLog('System', 'All services stopped', 'info');

            startButton.disabled = false;
            stopButton.disabled = true;
        }

        async function simulateServiceStart(serviceId) {
            updateLight(`light-${serviceId}`, 'connecting');
            await new Promise(resolve => setTimeout(resolve, 1500));
            updateLight(`light-${serviceId}`, 'active');
            return 'active';
        }

        function updateLastUpdate() {
            const updateElement = document.getElementById('last-update');
            const now = new Date().toLocaleString();
            updateElement.textContent = now;
        }

        function showMessage(type) {
            const successMsg = document.getElementById('success-message');
            const errorMsg = document.getElementById('error-message');

            if (type === 'success') {
                successMsg.style.display = 'block';
                setTimeout(() => {
                    successMsg.style.display = 'none';
                }, 3000);
            } else if (type === 'error') {
                errorMsg.style.display = 'block';
                setTimeout(() => {
                    errorMsg.style.display = 'none';
                }, 3000);
            }
        }
    </script>
</body>
</html>